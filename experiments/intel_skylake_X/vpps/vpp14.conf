#!/bin/bash

sudo /usr/bin/vpp -c startup14.conf
sleep 2

sudo vppctl -s /run/vpp/cli-vpp14.sock create memif socket id 15 filename /run/vpp/memif15.sock
sudo vppctl -s /run/vpp/cli-vpp14.sock create memif socket id 16 filename /run/vpp/memif16.sock

sudo vppctl -s /run/vpp/cli-vpp14.sock create interface memif id 15 socket-id 15 slave
sudo vppctl -s /run/vpp/cli-vpp14.sock set interface ip address memif15/15 10.10.17.2/24
sudo vppctl -s /run/vpp/cli-vpp14.sock set interface state memif15/15 up

sudo vppctl -s /run/vpp/cli-vpp14.sock create interface memif id 16 socket-id 16 master
sudo vppctl -s /run/vpp/cli-vpp14.sock set interface ip address memif16/16 10.10.18.1/24
sudo vppctl -s /run/vpp/cli-vpp14.sock set interface state memif16/16 up

#sudo vppctl -s /run/vpp/cli-vpp14.sock ip route add 10.10.2.0/24 via 10.10.18.2
#sudo vppctl -s /run/vpp/cli-vpp14.sock ip route add 10.10.1.0/24 via 10.10.17.1

sudo vppctl -s /run/vpp/cli-vpp14.sock ip route add 48.0.0.0/8 via 10.10.18.2

sudo vppctl -s /run/vpp/cli-vpp14.sock clear runtime
