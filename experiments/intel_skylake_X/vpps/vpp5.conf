#!/bin/bash

sudo /usr/bin/vpp -c startup5.conf
sleep 2

sudo vppctl -s /run/vpp/cli-vpp5.sock create memif socket id 5 filename /run/vpp/memif5.sock
sudo vppctl -s /run/vpp/cli-vpp5.sock create memif socket id 6 filename /run/vpp/memif6.sock
                               
sudo vppctl -s /run/vpp/cli-vpp5.sock create interface memif id 0 socket-id 5 slave
sudo vppctl -s /run/vpp/cli-vpp5.sock set interface ip address memif5/0 10.10.7.2/24
sudo vppctl -s /run/vpp/cli-vpp5.sock set interface state memif5/0 up
                               
sudo vppctl -s /run/vpp/cli-vpp5.sock create interface memif id 0 socket-id 6 master
sudo vppctl -s /run/vpp/cli-vpp5.sock set interface ip address memif6/0 10.10.8.1/24
sudo vppctl -s /run/vpp/cli-vpp5.sock set interface state memif6/0 up
                               
#sudo vppctl -s /run/vpp/cli-vpp5.sock ip route add 10.10.2.0/24 via 10.10.8.2
#sudo vppctl -s /run/vpp/cli-vpp5.sock ip route add 10.10.1.0/24 via 10.10.7.1
sudo vppctl -s /run/vpp/cli-vpp5.sock ip route add 48.0.0.0/8 via 10.10.8.2
                               
sudo vppctl -s /run/vpp/cli-vpp5.sock clear runtime
