#!/bin/bash

sudo /usr/bin/vpp -c startup7.conf
sleep 2

sudo vppctl -s /run/vpp/cli-vpp7.sock create memif socket id 7 filename /run/vpp/memif7.sock
sudo vppctl -s /run/vpp/cli-vpp7.sock create memif socket id 8 filename /run/vpp/memif8.sock

sudo vppctl -s /run/vpp/cli-vpp7.sock create interface memif id 7 socket-id 7 slave
sudo vppctl -s /run/vpp/cli-vpp7.sock set interface ip address memif7/7 10.10.9.2/24
sudo vppctl -s /run/vpp/cli-vpp7.sock set interface state memif7/7 up

sudo vppctl -s /run/vpp/cli-vpp7.sock create interface memif id 8 socket-id 8 master
sudo vppctl -s /run/vpp/cli-vpp7.sock set interface ip address memif8/8 10.10.10.1/24
sudo vppctl -s /run/vpp/cli-vpp7.sock set interface state memif8/8 up

#sudo vppctl -s /run/vpp/cli-vpp7.sock ip route add 10.10.2.0/24 via 10.10.10.2
#sudo vppctl -s /run/vpp/cli-vpp7.sock ip route add 10.10.1.0/24 via 10.10.9.1
sudo vppctl -s /run/vpp/cli-vpp7.sock ip route add 48.0.0.0/8 via 10.10.10.2

sudo vppctl -s /run/vpp/cli-vpp7.sock clear runtime
