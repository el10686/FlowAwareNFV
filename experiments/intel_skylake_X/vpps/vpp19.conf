#!/bin/bash

sudo /usr/bin/vpp -c startup19.conf
sleep 2

sudo vppctl -s /run/vpp/cli-vpp19.sock create memif socket id 6 filename /run/vpp/memif6.sock
sudo vppctl -s /run/vpp/cli-vpp19.sock create memif socket id 7 filename /run/vpp/memif7.sock

sudo vppctl -s /run/vpp/cli-vpp19.sock create interface memif id 1 socket-id 6 slave
sudo vppctl -s /run/vpp/cli-vpp19.sock set interface ip address memif6/1 10.10.23.2/24
sudo vppctl -s /run/vpp/cli-vpp19.sock set interface state memif6/1 up

sudo vppctl -s /run/vpp/cli-vpp19.sock create interface memif id 2 socket-id 6 slave
sudo vppctl -s /run/vpp/cli-vpp19.sock set interface ip address memif6/2 10.10.24.2/24
sudo vppctl -s /run/vpp/cli-vpp19.sock set interface state memif6/2 up

sudo vppctl -s /run/vpp/cli-vpp19.sock create interface memif id 2 socket-id 7 master
sudo vppctl -s /run/vpp/cli-vpp19.sock set interface ip address memif7/2 10.10.25.1/24
sudo vppctl -s /run/vpp/cli-vpp19.sock set interface state memif7/2 up

sudo vppctl -s /run/vpp/cli-vpp19.sock ip route add 48.0.0.0/8 via 10.10.25.2

sudo vppctl -s /run/vpp/cli-vpp19.sock clear runtime
